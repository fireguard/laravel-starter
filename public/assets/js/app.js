function addUrlParam(e,o){e=encodeURIComponent(e),o=encodeURIComponent(o);var a=window.location.search,t=e+"="+o,n=new RegExp("(&|\\?)"+e+"=[^&]*");return a=a.replace(n,"$1"+t),RegExp.$1||(a+=(a.length>0?"&":"?")+t),a}function removeUrlParam(e){sourceURL=window.location.search;var o,a=sourceURL.split("?")[0],t=[],n=sourceURL.indexOf("?")!==-1?sourceURL.split("?")[1]:"";if(""!==n){t=n.split("&");for(var s=t.length-1;s>=0;s-=1)o=t[s].split("=")[0],o===e&&t.splice(s,1);a=a+"?"+t.join("&")}return a}function getAlert(e,o){console.log(e,o)}function notifyLoading(e){jQuery("button.btn-primary").prop("disabled",e),e?jQuery("button i.fa-save").removeClass("fa-save").addClass("fa-refresh fa-spin"):jQuery("button i.fa-refresh.fa-spin").removeClass("fa-refresh fa-spin").addClass("fa-save")}function notifyReloadGrid(e){e&&(console.log("Reload Grid"),reloadCurrentPage())}function reloadCurrentPage(e){e&&e===!0?window.location.replace(removeUrlParam("search")):window.location.reload()}function openRemotePage(e,o){void 0==o&&(o="#default-modal");var a='<div class="text-center"><i class="fa fa-refresh fa-spin fa-3x fa-fw"></i><span class="sr-only">Loading...</span></div>',t=createModalBase('<i class="fa fa-spinner fa-spin"></i> Carregando',a);jQuery(o+"-content").html(t),jQuery(o).modal("show"),jQuery.ajax({type:"GET",async:!0,cache:!1,url:e}).done(function(e){jQuery(o+"-content").html(e)}).fail(function(e){jQuery(o+"-content").html(createErrorMessage(e))}).always(function(){})}function createModalBase(e,o,a){return void 0===a&&(a=""),'<div class="box '+a+'"> <div class="box-header with-border"> <h3 class="box-title"> '+e+' </h3> <div class="box-tools pull-right"> <button type="button" class="btn btn-box-tool" data-dismiss="modal" aria-hidden="true"><i class="fa fa-times"></i></button> </div> </div> <div class="box-body">'+o+"</div></div>"}function createErrorMessage(e){403==e.status&&window.location.replace("/manager");var o="Erro ao processar sua solicitação";404==e.status&&(o="A página solicitada não está disponível!");var a='<br><br><h3 class="text-center text-danger">'+o+"</h3><br><br>";return createModalBase('<div class="text-danger"><i class="fa fa-close "></i> Erro ao acessar a página solicitada</div>',a,"box-danger")}function removeDataTableItem(e,o,a){bootbox.confirm({title:"Atenção",message:"Deseja realmente remover este item?",buttons:{cancel:{label:"<i class='fa fa-times-circle'></i> Cancelar",className:"btn-default"},confirm:{label:"<i class='fa fa-minus-circle'></i> Remover",className:"btn-danger"}},callback:function(a){a&&(notifyLoading(!0),jQuery.ajax({url:e,method:"DELETE",async:!0,cache:!1,headers:{"X-CSRF-TOKEN":jQuery('meta[name="csrf-token"]').attr("content"),"Content-Type":"application/json"}}).done(function(e){var a=e.message||"Registro removido com sucesso!";getAlert(a,"success"),jQuery("#row-"+o).remove()}).fail(function(e){console.log(e);var o=e.message||"Não foi possível remover o registro solicitado!";getAlert(o,"error")}).always(function(){notifyLoading(!1)}))}})}function submitForm(e,o){"undefined"==typeof o&&(o=[]);var a=("undefined"==typeof o.type?"":o.type,"undefined"==typeof o.modal?"#default-modal":o.modal),t="undefined"==typeof o.urlBack?"":o.urlBack,n="undefined"==typeof o.method?"POST":o.method,s="undefined"==typeof o.reload||o.reload,i=jQuery("#"+e),r=i.attr("action")||"";jQuery(document).ready(function(){i.submit(function(e){e.preventDefault(),notifyLoading(!0);var c,l="application/x-www-form-urlencoded;charset=UTF-8",d=!0;"multipart/form-data"==i[0].enctype?(c=new FormData(this),l=!1,d=!1,n="POST"):c=i.serialize(),jQuery.ajax({url:r,method:n,async:!0,cache:!1,contentType:l,processData:d,data:c,headers:{"X-CSRF-TOKEN":jQuery('meta[name="csrf-token"]').attr("content")}}).done(function(e){if("object"!=typeof e)console.log(e),jQuery(a+"-content").html(e);else if(0==a)if(""===t||"undefined"==typeof e.data.id)window.location.href=t;else{var n=o.urlEdit;n=n.replace("?",e.data.id),n!==window.location.href&&(window.location.href=n),getAlert("Atualização salva com sucesso!","success")}else notifyReloadGrid(s),"function"==typeof jQuery(a).modal&&jQuery(a).modal("hide"),getAlert("Atualização salva com sucesso!","success")}).fail(function(e){if(422==e.status){getAlert("Verifique os itens em vermelho!","error");try{var o=e.responseJSON;jQuery.each(o,function(e,o){jQuery.each(o,function(o,a){console.log(e),jQuery("#"+e+"-input-message").html(a),jQuery("#"+e+"-form-group").addClass("has-error")})})}catch(e){console.log(e)}}}).always(function(){notifyLoading(!1)})})})}$(document).ajaxStart(function(){$("body").css({cursor:"wait"})}).ajaxStop(function(){$("body").css({cursor:"default"})}),$(document).ajaxError(function(e,o,a,t){403==o.status?bootbox.dialog({title:"Sessão Expirada",message:"A sessão atual expirou, por favor efetue o login para continuar acessando o sistema!",buttons:{main:{label:"<i class='fa fa-check-circle-o'></i> OK",className:"btn-primary",callback:function(){window.location.href="/auth/login"}}}}):404==o.status&&bootbox.dialog({title:"Erro",message:"A pagina solicitada não se encontra disponível",buttons:{cancel:{label:"<i class='fa fa-check-circle-o'></i> OK",className:"btn-primary"}}})}),$(document).on("hidden.bs.modal",function(e){$(e.target).removeData("bs.modal")}),navigator.userAgent.match(/iPhone|iPad|iPod/i)&&$(".modal").on("show.bs.modal",function(){$(this).css({position:"absolute",marginTop:$(window).scrollTop()+"px",bottom:"auto"}),setTimeout(function(){$(".modal-backdrop").css({position:"absolute",top:0,left:0,width:"100%",height:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)+"px"})},0)});